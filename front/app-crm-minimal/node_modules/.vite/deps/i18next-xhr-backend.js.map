{
  "version": 3,
  "sources": ["../../i18next-xhr-backend/dist/esm/i18nextXHRBackend.js"],
  "sourcesContent": ["import _classCallCheck from '@babel/runtime/helpers/esm/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/esm/createClass';\nimport _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport _typeof from '@babel/runtime/helpers/esm/typeof';\n\nvar arr = [];\nvar each = arr.forEach;\nvar slice = arr.slice;\nfunction defaults(obj) {\n  each.call(slice.call(arguments, 1), function (source) {\n    if (source) {\n      for (var prop in source) {\n        if (obj[prop] === undefined) obj[prop] = source[prop];\n      }\n    }\n  });\n  return obj;\n}\n\nfunction addQueryString(url, params) {\n  if (params && _typeof(params) === 'object') {\n    var queryString = '',\n        e = encodeURIComponent; // Must encode data\n\n    for (var paramName in params) {\n      queryString += '&' + e(paramName) + '=' + e(params[paramName]);\n    }\n\n    if (!queryString) {\n      return url;\n    }\n\n    url = url + (url.indexOf('?') !== -1 ? '&' : '?') + queryString.slice(1);\n  }\n\n  return url;\n} // https://gist.github.com/Xeoncross/7663273\n\n\nfunction ajax(url, options, callback, data, cache) {\n  if (data && _typeof(data) === 'object') {\n    if (!cache) {\n      data['_t'] = new Date();\n    } // URL encoded form data must be in querystring format\n\n\n    data = addQueryString('', data).slice(1);\n  }\n\n  if (options.queryStringParams) {\n    url = addQueryString(url, options.queryStringParams);\n  }\n\n  try {\n    var x;\n\n    if (XMLHttpRequest) {\n      x = new XMLHttpRequest();\n    } else {\n      x = new ActiveXObject('MSXML2.XMLHTTP.3.0');\n    }\n\n    x.open(data ? 'POST' : 'GET', url, 1);\n\n    if (!options.crossDomain) {\n      x.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n    }\n\n    x.withCredentials = !!options.withCredentials;\n\n    if (data) {\n      x.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n    }\n\n    if (x.overrideMimeType) {\n      x.overrideMimeType(\"application/json\");\n    }\n\n    var h = options.customHeaders;\n    h = typeof h === 'function' ? h() : h;\n\n    if (h) {\n      for (var i in h) {\n        x.setRequestHeader(i, h[i]);\n      }\n    }\n\n    x.onreadystatechange = function () {\n      x.readyState > 3 && callback && callback(x.responseText, x);\n    };\n\n    x.send(data);\n  } catch (e) {\n    console && console.log(e);\n  }\n}\n\nfunction getDefaults() {\n  return {\n    loadPath: '/locales/{{lng}}/{{ns}}.json',\n    addPath: '/locales/add/{{lng}}/{{ns}}',\n    allowMultiLoading: false,\n    parse: JSON.parse,\n    parsePayload: function parsePayload(namespace, key, fallbackValue) {\n      return _defineProperty({}, key, fallbackValue || '');\n    },\n    crossDomain: false,\n    ajax: ajax\n  };\n}\n\nvar Backend =\n/*#__PURE__*/\nfunction () {\n  function Backend(services) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Backend);\n\n    this.init(services, options);\n    this.type = 'backend';\n  }\n\n  _createClass(Backend, [{\n    key: \"init\",\n    value: function init(services) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      this.services = services;\n      this.options = defaults(options, this.options || {}, getDefaults());\n    }\n  }, {\n    key: \"readMulti\",\n    value: function readMulti(languages, namespaces, callback) {\n      var loadPath = this.options.loadPath;\n\n      if (typeof this.options.loadPath === 'function') {\n        loadPath = this.options.loadPath(languages, namespaces);\n      }\n\n      var url = this.services.interpolator.interpolate(loadPath, {\n        lng: languages.join('+'),\n        ns: namespaces.join('+')\n      });\n      this.loadUrl(url, callback);\n    }\n  }, {\n    key: \"read\",\n    value: function read(language, namespace, callback) {\n      var loadPath = this.options.loadPath;\n\n      if (typeof this.options.loadPath === 'function') {\n        loadPath = this.options.loadPath([language], [namespace]);\n      }\n\n      var url = this.services.interpolator.interpolate(loadPath, {\n        lng: language,\n        ns: namespace\n      });\n      this.loadUrl(url, callback);\n    }\n  }, {\n    key: \"loadUrl\",\n    value: function loadUrl(url, callback) {\n      var _this = this;\n\n      this.options.ajax(url, this.options, function (data, xhr) {\n        if (xhr.status >= 500 && xhr.status < 600) return callback('failed loading ' + url, true\n        /* retry */\n        );\n        if (xhr.status >= 400 && xhr.status < 500) return callback('failed loading ' + url, false\n        /* no retry */\n        );\n        var ret, err;\n\n        try {\n          ret = _this.options.parse(data, url);\n        } catch (e) {\n          err = 'failed parsing ' + url + ' to json';\n        }\n\n        if (err) return callback(err, false);\n        callback(null, ret);\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(languages, namespace, key, fallbackValue) {\n      var _this2 = this;\n\n      if (typeof languages === 'string') languages = [languages];\n      var payload = this.options.parsePayload(namespace, key, fallbackValue);\n      languages.forEach(function (lng) {\n        var url = _this2.services.interpolator.interpolate(_this2.options.addPath, {\n          lng: lng,\n          ns: namespace\n        });\n\n        _this2.options.ajax(url, _this2.options, function (data, xhr) {//const statusCode = xhr.status.toString();\n          // TODO: if statusCode === 4xx do log\n        }, payload);\n      });\n    }\n  }]);\n\n  return Backend;\n}();\n\nBackend.type = 'backend';\n\nexport default Backend;\n"],
  "mappings": "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",
  "names": ["Backend"]
}
